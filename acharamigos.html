<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RealMe</title>
  <link rel="icon" href="./src/icon/icon.png" type="image/png" />
  <meta name="theme-color" content="#1F1F1F" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="apple-touch-icon" href="./src/icon/icon.png" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link rel="stylesheet" href="./src/styles/base.css" />
  <link rel="stylesheet" href="./src/styles/sobre.css" />
  <link rel="stylesheet" href="./src/styles/amigos.css" />
  <link rel="stylesheet" href="./src/styles/media-queries.css" />
  <link rel="stylesheet" href="./src/styles/navbars.css" />
  <link rel="stylesheet" href="./src/styles/search.css" />
  <link rel="stylesheet" href="./src/styles/post-modal.css" />
</head>
<body>

  <div class="glass-overlay"></div>

  <!-- Navbar -->
  <nav>
    <div class="logo_area">
      <div class="logo">RealMe</div>
    </div>
    <div class="search-area">
  <div class="search-box">
    <button><i class="fas fa-search"></i></button>
    <input type="text" id="searchInput" placeholder="Buscar" autocomplete="off" />
  </div>
    </div>
    <div class="last-update-area">
      <div class="last-update">
        <p>Novidades!</p>
      </div>
    </div>
    <div class="marquee-container">
      <div class="marquee">marcio_marques acabou de postar uma foto...</div>
    </div>
  </nav>

  <!-- Sidebar Desktop -->
  <!-- Sidebar -->
  <aside class="sidebar">
    <a href="feed.html"><i class="fas fa-home"></i> In√≠cio</a>
    <a href="acharamigos.html"><i class="fas fa-user-friends"></i> Achar Amigos</a>
    <a href="direct.html"><i class="fas fa-comments"></i> Mensagens</a>
    <a href="nt.html"><i class="fas fa-bell"></i> Notifica√ß√µes</a>
    <a href="#" class="modalopen"><i class="fas fa-plus-square"></i> Criar</a>
    <a href="#" id="linkPerfilSidebar"><i class="fas fa-user"></i> Perfil</a>
    <!-- Menu Mais com submenu flutuante -->
        <div class="more-menu" id="moreMenu">
            <a href="#" class="more-toggle" id="moreToggle">
                <i class="fa-solid fa-bars"></i>
                Mais
            </a>
            <div class="floating-menu" id="floatingMenu">
                <a href="config.html"><i class="fas fa-cog"></i> Configura√ß√µes</a>
                <a href="invites.html"><i class="fa-solid fa-user-plus"></i> Convites</a>
                <a href="como-usar.html"><i class="fa-solid fa-book-open"></i> Como Usar</a>
                <a href="sobre.html"><i class="fas fa-question-circle"></i> Sobre</a>
                <a href="#" id="btnSair"><i class="fas fa-sign-out-alt"></i> Sair</a>
            </div>
        </div>
  </aside>
  <ul id="searchResults"></ul>

  <div class="friends-container">
        <div class="friends-header">
            <h1>Pessoas parecidas com voc√™!</h1>
            <div class="view-toggle">
                <button class="toggle-btn active" data-view="carousel">Cards</button>
                <button class="toggle-btn" data-view="grid">Grid</button>
            </div>
        </div>

        <!-- VIEW GRID (Original) -->
        <div class="grid-view" id="gridView">
            <div class="friends-list">
                <a class="user" href="#" data-username="afliccoess">
                    <img src="https://lastfm.freetls.fastly.net/i/u/avatar170s/3c04e79db06c605e5de3897555a9a34e.png" alt="Vini demarco">
                    <div class="user-name">
                        <div class="profile-name">
                            <p>Vini demarco</p>
                        </div>
                        <div class="profile-username">
                            <p>@afliccoess</p>
                        </div>
                    </div>
                </a>
                <a class="user" href="#" data-username="vampirinhaz7">
                    <img src="https://cdn.pfps.gg/pfps/1869-goth-egirl-27.png" alt="Mari">
                    <div class="user-name">
                        <div class="profile-name">
                            <p>ñ§çñ§åñ§ç Mari Saverio</p>
                        </div>
                        <div class="profile-username">
                            <p>@vampirinhaz7</p>
                        </div>
                    </div>
                </a>
                <a class="user" href="#" data-username="maxgfortes">
                    <img src="https://i.pinimg.com/736x/d6/fc/2a/d6fc2ab598fdc5ffee863bd5835746c8.jpg" alt="Max">
                    <div class="user-name">
                        <div class="profile-name">
                            <p>maxgfortes</p>
                        </div>
                        <div class="profile-username">
                            <p>@maxgfortes</p>
                        </div>
                    </div>
                </a>
                <a class="user" href="#" data-username="maxine">
                    <img src="https://i.pinimg.com/736x/0e/10/35/0e1035c960796eccbc18608793cfa3e9.jpg" alt="Maxine">
                    <div class="user-name">
                        <div class="profile-name">
                            <p>‚ãÜÀöÔΩ°‚ãÜ‡≠®‚úß‡≠ßÀö ùë¥ùíÇùíôùíäùíèùíÜ Àö‡≠®‚úß‡≠ß‚ãÜÔΩ°Àö‚ãÜ</p>
                        </div>
                        <div class="profile-username">
                            <p>@maxine</p>
                        </div>
                    </div>
                </a>
                <a class="user" href="#" data-username="davix">
                    <img src="https://i.pinimg.com/736x/12/d3/dd/12d3dd5ac7a32f43cf867161cb95774f.jpg" alt="David">
                    <div class="user-name">
                        <div class="profile-name">
                            <p>warrsex</p>
                        </div>
                        <div class="profile-username">
                            <p>@davix</p>
                        </div>
                    </div>
                </a>
                <a class="user" href="#" data-username="haspkey">
                    <img src="https://i.postimg.cc/CK3qy1w5/image.png" alt="Haspkey">
                    <div class="user-name">
                        <div class="profile-name">
                            <p>haspkey</p>
                        </div>
                        <div class="profile-username">
                            <p>@haspkey</p>
                        </div>
                    </div>
                </a>
            </div>
        </div>


  <!-- VIEW CAROUSEL (Novo) -->
        <div class="carousel-view active" id="carouselView">
            <div class="carousel-container">
                <div class="cards-wrapper" id="cardsWrapper">
                    <!-- Cards ser√£o gerados dinamicamente -->
                </div>
            </div>
            <div class="carousel-controls">
                <button class="nav-btn" id="prevBtn">‚Äπ</button>
                <div class="indicators" id="indicators"></div>
                <button class="nav-btn" id="nextBtn">‚Ä∫</button>
            </div>
        </div>
    </div>

<aside class="option-bar">
  <h1>Preferencias</h1>
  <div class="options">
      <!-- Checkbox ‚ÄúIgual a mim‚Äù -->
      <div class="lm">
        <p>Igual a mim</p>
        <label class="switch">
          <input type="checkbox" id="igualAMim">
          <span class="slider"></span>
        </label>
      </div>
  <div class="filtros">
    <div class="estilo">
      <p>Estilo</p>
      <input class="estilo" type="text" placeholder="gotico, alternativo, sk8 archive...">
    </div>

    <div class="estilo">
      <p>Personalidade</p>
      <input class="estilo" type="text" placeholder="extrovertido, introvertido...">
    </div>

    <div class="estilo">
      <p>Medos</p>
      <input class="estilo" type="text" placeholder="Medo de Acabar Sozinho...">
    </div>

    <div class="estilo">
      <p>Sonhos e Desejos</p>
      <input class="estilo" type="text" placeholder="Conex√£o real, Amor, Dinheiro...">
    </div>

    <div class="estilo">
      <p>Musicas</p>
      <input class="estilo" type="text" placeholder="Rock, Grunge, Pop, Alt, Indie...">
    </div>

    <div class="estilo">
      <p>Personagens</p>
      <input class="estilo" type="text" placeholder="Jesse Pinkman, Cassie, Marla...">
    </div>

    <div class="estilo">
      <p>localiza√ß√£o</p>
      <input class="estilo" type="text" placeholder="S√£o Paulo, Porto Alegre...">
    </div>

    <div class="estilo">
      <p>Hobbies</p>
      <input class="estilo" type="text" placeholder="Esportes, Pintura, Musica...">
    </div>

    <div class="selecoes">
      <p>Genero</p>
      <select id="genero">
        <option value="">Qualquer</option>
        <option value="Masculino">Masculino</option>
        <option value="Feminino">Feminino</option>
        <option value="binario">N√£o Binario</option>
      </select>
    </div>

    <div class="selecoes">
      <p>Estado Civil</p>
      <select id="genero">
        <option value="">Namorando</option>
        <option value="Masculino">Solteiro</option>
        <option value="Feminino">Casado</option>
        <option value="binario">Em compromisso</option>
        <option value="binario">Viuvo</option>
      </select>
    </div>

    <div class="selecoes">
      <p>MBTI</p>
      <select id="genero">
        <option value="">ISTJ</option>
        <option value="Masculino">ISFJ</option>
        <option value="Feminino">INFJ</option>
        <option value="binario">INTJ</option>
        <option value="binario">ISTP</option>
        <option value="binario">ISFP</option>
        <option value="binario">INTJ</option>
        <option value="binario">INFP</option>
        <option value="binario">INTP</option>
        <option value="binario">ESTP</option>
        <option value="binario">ESFP</option>
        <option value="binario">ENFP</option>
        <option value="binario">ENTP</option>
        <option value="binario">ESTJ</option>
        <option value="binario">ESFJ</option>
        <option value="binario">ENFJ</option>
        <option value="binario">ENTJ</option>
      </select>
    </div>    
    <div class="age">
      <div class="age-range">
        <p>Idade minima</p>
        <input class="age-input" type="number" id="idade-min" min="13" max="78" value="14">
      </div>
      <div class="age-range">
        <p>Idade Maxima</p>
        <input class="age-input" type="number" id="idade-max" min="13" max="78" step="1" value="17">
      </div>
    </div>

  </div>
</div>

  <!-- Bot√£o fixo -->
  <button class="search-btn" type="submit" form="search-form">Buscar!</button>
  </div>
</aside>
</div>

<!-- Modal Post Container -->
    <div id="postmodal" class="modal-post-container">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Criar Novo <span>Post</span>!</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-greeting">
              <p>Como est√° sendo o seu dia? Fa√ßa um post sobre isso.</p>
            </div>
            <div class="modal-body">
                <input type="text" class="textarea-post" placeholder="Escreva um pensamento..." maxlength="100">
                <button class="btn-sending">Enviar!</button>
            </div>
        </div>
    </div>

<script src="./src/js/postmodal.js"></script>
<script src="/js/mobile-lock.js"></script>
<script type="module" src="./src/js/main-main.js"></script>
<script type="module">
// Imports do Firebase (apenas uma vez)
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import {
  getFirestore,
  collection,
  query,
  orderBy,
  startAt,
  endAt,
  getDocs,
  doc,
  getDoc,
  setDoc
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
import { 
  getStorage, 
  ref, 
  uploadBytes, 
  getDownloadURL 
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js";

// Configura√ß√£o do Firebase (apenas uma vez)
const firebaseConfig = {
  apiKey: "AIzaSyB2N41DiH0-Wjdos19dizlWSKOlkpPuOWs",
  authDomain: "ifriendmatch.firebaseapp.com",
  projectId: "ifriendmatch",
  storageBucket: "ifriendmatch.appspot.com",
  messagingSenderId: "306331636603",
  appId: "1:306331636603:web:c0ae0bd22501803995e3de",
  measurementId: "G-D96BEW6RC3"
};

// Inicializar Firebase
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);
const storage = getStorage(app);

document.addEventListener('DOMContentLoaded', () => {
  console.log('DOM carregado, inicializando aplica√ß√£o');

  // Verificar se usu√°rio est√° logado
  const usuarioLogadoJSON = localStorage.getItem('usuarioLogado');
  if (!usuarioLogadoJSON) {
    alert('Voc√™ precisa estar logado para acessar esta p√°gina.');
    window.location.href = 'login.html';
    return;
  }

  const usuarioLogado = JSON.parse(usuarioLogadoJSON);
  const username = usuarioLogado.username;

  // Atualizar informa√ß√µes do usu√°rio na p√°gina
  const nomeCompleto = document.getElementById("nomeCompleto");
  if (nomeCompleto) {
    nomeCompleto.textContent = `${usuarioLogado.nome || ''} ${usuarioLogado.sobrenome || ''}`;
  }

  const usernameElement = document.getElementById("username");
  if (usernameElement) {
    usernameElement.textContent = `@${usuarioLogado.username}`;
  }

  // Atualizar links de perfil
  const urlPerfil = `PF.html?user=${encodeURIComponent(username)}`;
  const linkSidebar = document.getElementById('linkPerfilSidebar');
  const linkMobile = document.getElementById('linkPerfilMobile');
  if(linkSidebar) linkSidebar.href = urlPerfil;
  if(linkMobile) linkMobile.href = urlPerfil;

  // ===================
  // FUNCIONALIDADE DAS ABAS
  // ===================
  document.querySelectorAll('.tab-button').forEach(button => {
    button.addEventListener('click', () => {
      // Remove active class from all tabs and contents
      document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
      
      // Add active class to clicked tab and corresponding content
      button.classList.add('active');
      const tabContent = document.getElementById(button.dataset.tab);
      if (tabContent) {
        tabContent.classList.add('active');
      }
    });
  });

  // ===================
  // CONTADOR DE CARACTERES
  // ===================
  function atualizarContadores() {
    document.querySelectorAll('textarea[maxlength], input[maxlength]').forEach(element => {
      const counter = element.parentNode.querySelector('.char-counter');
      if (counter) {
        const maxLength = parseInt(element.getAttribute('maxlength'));
        
        const updateCounter = () => {
          const currentLength = element.value.length;
          counter.textContent = `${currentLength}/${maxLength}`;
          
          // Add warning classes
          counter.classList.remove('warning', 'danger');
          if (currentLength > maxLength * 0.9) {
            counter.classList.add('danger');
          } else if (currentLength > maxLength * 0.75) {
            counter.classList.add('warning');
          }
        };
        
        element.addEventListener('input', updateCounter);
        updateCounter(); // Initial count
      }
    });
  }

  // ===================
  // FUNCIONALIDADE DE BUSCA
  // ===================
  const searchInput = document.getElementById("searchInput");
  const resultsList = document.getElementById("searchResults");
  const searchButton = document.querySelector(".search-box button");

  if (searchInput && resultsList && searchButton) {
    async function performSearch() {
      const term = searchInput.value.trim().toLowerCase();
      resultsList.innerHTML = "";
      resultsList.classList.remove("visible");

      if (!term) return;

      const usersRef = collection(db, "users");
      const q = query(usersRef, orderBy("username"), startAt(term), endAt(term + "\uf8ff"));

      try {
        const snapshot = await getDocs(q);
        if (snapshot.empty) {
          resultsList.innerHTML = "<li>Nenhum usu√°rio encontrado</li>";
          resultsList.classList.add("visible");
          return;
        }

        snapshot.forEach((docSnap) => {
          const user = docSnap.data();
          const li = document.createElement("li");
          li.textContent = user.username;
          li.addEventListener("click", () => {
            window.location.href = `PF.html?username=${user.username}`;
          });
          resultsList.appendChild(li);
        });

        resultsList.classList.add("visible");
      } catch (err) {
        console.error("Erro na busca:", err);
        resultsList.innerHTML = "<li>Erro na busca</li>";
        resultsList.classList.add("visible");
      }
    }

    searchButton.addEventListener("click", (e) => {
      e.preventDefault();
      performSearch();
    });

    searchInput.addEventListener("input", performSearch);

    document.addEventListener("click", (e) => {
      if (!e.target.closest(".search-area")) {
        resultsList.classList.remove("visible");
      }
    });
  }

  // ===================
  // CARREGAR DADOS EXISTENTES
  // ===================
  async function carregarDadosUsuario() {
    try {
      const userRef = doc(db, "users", username);
      const userSnap = await getDoc(userRef);
      
      if (userSnap.exists()) {
        const userData = userSnap.data();
        preencherFormulario(userData);
      }
    } catch (error) {
      console.error("Erro ao carregar dados do usu√°rio:", error);
    }
  }

  // Preencher formul√°rio com dados existentes
  function preencherFormulario(userData) {
    // Informa√ß√µes b√°sicas
    const usernameInput = document.querySelector('input[name="username"]');
    if (usernameInput && userData.username) usernameInput.value = userData.username;
    
    const displaynameInput = document.querySelector('input[name="displayname"]');
    if (displaynameInput && userData.displayname) displaynameInput.value = userData.displayname;
    
    const pronoun1Input = document.querySelector('input[name="pronoun1"]');
    if (pronoun1Input && userData.pronoun1) pronoun1Input.value = userData.pronoun1;
    
    const userphotoInput = document.querySelector('input[name="userphoto"]');
    if (userphotoInput && userData.userphoto) userphotoInput.value = userData.userphoto;
    
    const backgroundphotoInput = document.querySelector('input[name="backgroundphoto"]');
    if (backgroundphotoInput && userData.backgroundphoto) backgroundphotoInput.value = userData.backgroundphoto;
    
    const headerphotoInput = document.querySelector('input[name="headerphoto"]');
    if (headerphotoInput && userData.headerphoto) headerphotoInput.value = userData.headerphoto;
    
    const pronoun2Input = document.querySelector('input[name="pronoun2"]');
    if (pronoun2Input && userData.pronoun2) pronoun2Input.value = userData.pronoun2;
    
    const estadoCivilSelect = document.querySelector('select[name="estadoCivil"]');
    if (estadoCivilSelect && userData.estadoCivil) estadoCivilSelect.value = userData.estadoCivil;
    
    const localizacaoInput = document.querySelector('input[name="localizacao"]');
    if (localizacaoInput && userData.localizacao) localizacaoInput.value = userData.localizacao;

    // Descri√ß√£o
    const tagsInput = document.querySelector('input[name="tags"]');
    if (tagsInput && userData.tags) tagsInput.value = userData.tags;
    
    const visaoGeralTextarea = document.querySelector('textarea[name="visaoGeral"]');
    if (visaoGeralTextarea && userData.visaoGeral) visaoGeralTextarea.value = userData.visaoGeral;
    
    const estiloTextarea = document.querySelector('textarea[name="estilo"]');
    if (estiloTextarea && userData.estilo) estiloTextarea.value = userData.estilo;

    // Personalidade
    const sonhosTextarea = document.querySelector('textarea[name="sonhos"]');
    if (sonhosTextarea && userData.sonhos) sonhosTextarea.value = userData.sonhos;
    
    const medosTextarea = document.querySelector('textarea[name="medos"]');
    if (medosTextarea && userData.medos) medosTextarea.value = userData.medos;
    
    const personalidadeTextarea = document.querySelector('textarea[name="personalidade"]');
    if (personalidadeTextarea && userData.personalidade) personalidadeTextarea.value = userData.personalidade;

    // Prefer√™ncias
    const gostosTextarea = document.querySelector('textarea[name="gostos"]');
    if (gostosTextarea && userData.gostos) gostosTextarea.value = userData.gostos;
    
    const musicasTextarea = document.querySelector('textarea[name="musicas"]');
    if (musicasTextarea && userData.musicas) musicasTextarea.value = userData.musicas;
    
    const filmesSeriesTextarea = document.querySelector('textarea[name="filmesSeries"]');
    if (filmesSeriesTextarea && userData.filmesSeries) filmesSeriesTextarea.value = userData.filmesSeries;
    
    const livrosTextarea = document.querySelector('textarea[name="livros"]');
    if (livrosTextarea && userData.livros) livrosTextarea.value = userData.livros;
    
    const personagensTextarea = document.querySelector('textarea[name="personagens"]');
    if (personagensTextarea && userData.personagens) personagensTextarea.value = userData.personagens;
    
    const comidasTextarea = document.querySelector('textarea[name="comidas"]');
    if (comidasTextarea && userData.comidas) comidasTextarea.value = userData.comidas;
    
    const hobbiesTextarea = document.querySelector('textarea[name="hobbies"]');
    if (hobbiesTextarea && userData.hobbies) hobbiesTextarea.value = userData.hobbies;
    
    const jogosTextarea = document.querySelector('textarea[name="jogos"]');
    if (jogosTextarea && userData.jogos) jogosTextarea.value = userData.jogos;
    
    const outrosGostosTextarea = document.querySelector('textarea[name="outrosGostos"]');
    if (outrosGostosTextarea && userData.outrosGostos) outrosGostosTextarea.value = userData.outrosGostos;

    // Conta
    const emailInput = document.querySelector('input[name="email"]');
    if (emailInput && userData.email) emailInput.value = userData.email;
    
    const telefoneInput = document.querySelector('input[name="telefone"]');
    if (telefoneInput && userData.telefone) telefoneInput.value = userData.telefone;

    // Atualizar contadores ap√≥s preencher
    setTimeout(atualizarContadores, 100);
  }

  // ===================
  // SALVAR CONFIGURA√á√ïES
  // ===================
  const form = document.querySelector('form');
  if (form) {
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const submitBtn = document.querySelector('.submit-btn');
      const originalText = submitBtn ? submitBtn.textContent : 'Salvar Configura√ß√µes';
      
      if (submitBtn) {
        submitBtn.textContent = 'Salvando...';
        submitBtn.disabled = true;
      }

      try {
        console.log('Iniciando salvamento das configura√ß√µes...');

        // Coletar dados do formul√°rio
        const formData = new FormData(form);
        const dadosParaSalvar = {
          username: username,
          ultimaAtualizacao: new Date().toISOString()
        };

        // Converter FormData para objeto
        for (const [chave, valor] of formData.entries()) {
          if (valor && valor.trim() !== '') {
            dadosParaSalvar[chave] = valor;
          }
        }

        // Salvar no Firestore
        const userRef = doc(db, 'users', username);
        await setDoc(userRef, dadosParaSalvar, { merge: true });

        // Atualizar localStorage com novos dados
        const dadosAtualizados = { ...usuarioLogado, ...dadosParaSalvar };
        localStorage.setItem('usuarioLogado', JSON.stringify(dadosAtualizados));

        alert('Configura√ß√µes salvas com sucesso!');
        console.log('Dados salvos:', dadosParaSalvar);

      } catch (error) {
        console.error('Erro ao salvar configura√ß√µes:', error);
        alert('Erro ao salvar as configura√ß√µes: ' + error.message);
      } finally {
        if (submitBtn) {
          submitBtn.textContent = originalText;
          submitBtn.disabled = false;
        }
      }
    });
  }

  // Funcionalidade extra para menus (se existir)
  const menuItems = document.querySelectorAll('.menu-item');
  const tabs = document.querySelectorAll('.tab');

  if (menuItems.length > 0 && tabs.length > 0) {
    menuItems.forEach((item, index) => {
      item.addEventListener('click', () => {
        // Troca abas
        tabs.forEach(tab => tab.classList.remove('active'));
        if (tabs[index]) tabs[index].classList.add('active');

        // Troca bot√£o ativo
        menuItems.forEach(btn => btn.classList.remove('active'));
        item.classList.add('active');
      });
    });
  }

  // Inicializar funcionalidades
  carregarDadosUsuario();
  atualizarContadores();
});
</script>

<script src="./src/js/more.js"></script>
    <script>
        // Fun√ß√£o para alternar se√ß√µes
        function toggleSection(section) {
            section.classList.toggle('active');
            
            // Adiciona efeito de ondula√ß√£o
            const ripple = document.createElement('div');
            ripple.style.position = 'absolute';
            ripple.style.borderRadius = '50%';
            ripple.style.background = 'rgba(52, 152, 219, 0.3)';
            ripple.style.transform = 'scale(0)';
            ripple.style.animation = 'ripple 0.6s linear';
            ripple.style.left = '50%';
            ripple.style.top = '50%';
            
            section.appendChild(ripple);
            
            setTimeout(() => {
                ripple.remove();
            }, 600);
        }

        // Fun√ß√£o para expandir todas as se√ß√µes
        function expandAll() {
            const sections = document.querySelectorAll('.realme-section');
            sections.forEach((section, index) => {
                setTimeout(() => {
                    section.classList.add('active');
                }, index * 100);
            });
        }

        // Fun√ß√£o para recolher todas as se√ß√µes
        function collapseAll() {
            const sections = document.querySelectorAll('.realme-section');
            sections.forEach((section, index) => {
                setTimeout(() => {
                    section.classList.remove('active');
                }, index * 100);
            });
        }

        // Criar part√≠culas flutuantes
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 50;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.top = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 6 + 's';
                particle.style.animationDuration = (Math.random() * 4 + 4) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Barra de progresso de scroll
        function updateProgressBar() {
            const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (winScroll / height) * 100;
            document.getElementById('progressBar').style.width = scrolled + '%';
        }

        // Adicionar CSS para anima√ß√£o de ondula√ß√£o
        const style = document.createElement('style');
        style.textContent = `
            @keyframes ripple {
                to {
                    transform: scale(4);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Inicializar quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', function() {
            createParticles();
            
            // Adicionar listener para barra de progresso
            window.addEventListener('scroll', updateProgressBar);
            
            // Efeito de apari√ß√£o suave dos elementos
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            });

            document.querySelectorAll('.realme-section').forEach(section => {
                observer.observe(section);
            });
        });

        // Adicionar efeitos de teclado para acessibilidade
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' || e.key === ' ') {
                const focusedElement = document.activeElement;
                if (focusedElement.classList.contains('section-header') || focusedElement.closest('.realme-section')) {
                    e.preventDefault();
                    const section = focusedElement.closest('.realme-section') || focusedElement.parentElement;
                    toggleSection(section);
                }
            }
        });

        // Tornar se√ß√µes focus√°veis para acessibilidade
        document.querySelectorAll('.realme-section').forEach(section => {
            section.setAttribute('tabindex', '0');
            section.setAttribute('role', 'button');
            section.setAttribute('aria-expanded', 'false');
            
            section.addEventListener('click', function() {
                const isActive = this.classList.contains('active');
                this.setAttribute('aria-expanded', isActive ? 'true' : 'false');
            });
        });
    </script>
    <script>
(function () {
  // largura √∫til do container (sem padding/borda)
  function getAvailableWidth(el) {
    const cs = getComputedStyle(el);
    const paddingX = parseFloat(cs.paddingLeft) + parseFloat(cs.paddingRight);
    const borderX  = parseFloat(cs.borderLeftWidth) + parseFloat(cs.borderRightWidth);
    return el.getBoundingClientRect().width - paddingX - borderX;
  }

  function fitOne(el, min=12, max=22) {
    const parent = el.parentElement;
    if (!parent) return;

    // preparar para medir
    el.style.whiteSpace   = 'nowrap';
    el.style.overflow     = 'visible';
    el.style.textOverflow = 'clip';
    el.style.display      = 'inline-block';
    el.style.maxWidth     = '100%';

    const avail = Math.floor(getAvailableWidth(parent));
    if (avail <= 0) return;

    // come√ßa no m√°ximo
    let lo = min, hi = max, best = min;
    el.style.fontSize = max + 'px';

    // busca bin√°ria: ajusta at√© caber
    while (lo <= hi) {
      const mid = Math.floor((lo + hi) / 2);
      el.style.fontSize = mid + 'px';
      const tooWide = el.scrollWidth > avail;
      if (tooWide) hi = mid - 1;
      else { best = mid; lo = mid + 1; }
    }
    el.style.fontSize = best + 'px';
  }

  function fitAll(selector='.profile-name p', min=12, max=22) {
    document.querySelectorAll(selector).forEach(el => fitOne(el, min, max));
  }

  // roda quando tudo est√° pronto
  function bootstrap() {
    fitAll();
    // re-ajusta ao redimensionar
    window.addEventListener('resize', () => fitAll());
    // observa mudan√ßas no tamanho dos containers
    const ro = new ResizeObserver(() => fitAll());
    document.querySelectorAll('.profile-name').forEach(p => ro.observe(p));
  }

  if (document.fonts && document.fonts.ready) {
    document.fonts.ready.then(bootstrap);
  } else if (document.readyState === 'complete') {
    bootstrap();
  } else {
    window.addEventListener('load', bootstrap);
  }
})();
</script>

<script>
        // Dados dos usu√°rios
        const users = [
            {
                name: "Vini demarco",
                username: "@afliccoess",
                image: "https://lastfm.freetls.fastly.net/i/u/avatar170s/3c04e79db06c605e5de3897555a9a34e.png",
                profile: "PF.html?username=afliccoess"
            },
            {
                name: "ñ§çñ§åñ§ç Mari Saverio",
                username: "@vampirinhaz7",
                image: "https://cdn.pfps.gg/pfps/1869-goth-egirl-27.png",
                profile: "PF.html?username=vampirinhaz7"
            },
            {
                name: "maxgfortes",
                username: "@maxgfortes",
                image: "https://i.pinimg.com/736x/d6/fc/2a/d6fc2ab598fdc5ffee863bd5835746c8.jpg",
                profile: "PF.html?username=maxgfortes"
            },
            {
                name: "‚ãÜÀöÔΩ°‚ãÜ‡≠®‚úß‡≠ßÀö ùë¥ùíÇùíôùíäùíèùíÜ Àö‡≠®‚úß‡≠ß‚ãÜÔΩ°Àö‚ãÜ",
                username: "@maxine",
                image: "https://i.pinimg.com/736x/0e/10/35/0e1035c960796eccbc18608793cfa3e9.jpg",
                profile: "PF.html?username=maxine"
            },
            {
                name: "warrsex",
                username: "@davix",
                image: "https://i.pinimg.com/736x/12/d3/dd/12d3dd5ac7a32f43cf867161cb95774f.jpg",
                profile: "PF.html?username=davix"
            },
            {
                name: "haspkey",
                username: "@haspkey",
                image: "https://i.postimg.cc/CK3qy1w5/image.png",
                profile: "PF.html?username=haspkey"
            }
        ];

        class FriendsCarousel {
            constructor() {
                this.currentIndex = 0;
                this.users = users;
                this.cardsWrapper = document.getElementById('cardsWrapper');
                this.indicators = document.getElementById('indicators');
                this.isTransitioning = false;
                
                this.init();
            }

            init() {
                this.createCards();
                this.createIndicators();
                this.bindEvents();
                this.updateDisplay();
            }

            createCards() {
                this.cardsWrapper.innerHTML = '';
                
                this.users.forEach((user, index) => {
                    const card = document.createElement('div');
                    card.className = 'friend-card';
                    card.innerHTML = `
                        <div class="card-content">
                            <img src="${user.image}" alt="${user.name}" class="card-image">
                            <div class="card-info">
                                <div class="card-name">${user.name}</div>
                                <div class="card-username">${user.username}</div>
                            </div>
                            <a href="${user.profile}" class="view-profile-btn"><p>Ver Perfil</p>
                            </a>
                        </div>
                    `;
                    
                    // Adicionar event listener para navega√ß√£o por clique
                    card.addEventListener('click', (e) => {
                        if (!e.target.closest('.view-profile-btn')) {
                            this.goToSlide(index);
                        }
                    });
                    
                    this.cardsWrapper.appendChild(card);
                });
            }

            createIndicators() {
                this.indicators.innerHTML = '';
                
                this.users.forEach((_, index) => {
                    const indicator = document.createElement('div');
                    indicator.className = 'indicator';
                    if (index === 0) indicator.classList.add('active');
                    
                    indicator.addEventListener('click', () => {
                        this.goToSlide(index);
                    });
                    
                    this.indicators.appendChild(indicator);
                });
            }

            updateDisplay() {
                const cards = this.cardsWrapper.children;
                const totalCards = cards.length;
                
                // Remover todas as classes de posi√ß√£o
                Array.from(cards).forEach(card => {
                    card.classList.remove('center', 'left', 'right', 'far-left', 'far-right', 'hidden');
                });

                // Aplicar classes baseadas na posi√ß√£o relativa ao currentIndex
                Array.from(cards).forEach((card, index) => {
                    const relativePos = this.getRelativePosition(index, this.currentIndex, totalCards);
                    
                    switch (relativePos) {
                        case 0: card.classList.add('center'); break;
                        case 1: card.classList.add('right'); break;
                        case -1: card.classList.add('left'); break;
                        case 2: card.classList.add('far-right'); break;
                        case -2: card.classList.add('far-left'); break;
                        default: card.classList.add('hidden'); break;
                    }
                });

                // Atualizar indicadores
                const indicatorElements = this.indicators.children;
                Array.from(indicatorElements).forEach((indicator, index) => {
                    indicator.classList.toggle('active', index === this.currentIndex);
                });
            }

            getRelativePosition(cardIndex, currentIndex, totalCards) {
                let diff = cardIndex - currentIndex;
                
                // Normalizar para o intervalo [-totalCards/2, totalCards/2]
                if (diff > totalCards / 2) {
                    diff -= totalCards;
                } else if (diff < -totalCards / 2) {
                    diff += totalCards;
                }
                
                return diff;
            }

            goToSlide(index) {
                if (this.isTransitioning || index === this.currentIndex) return;
                
                this.isTransitioning = true;
                this.currentIndex = index;
                this.updateDisplay();
                
                // Permitir nova transi√ß√£o ap√≥s anima√ß√£o
                setTimeout(() => {
                    this.isTransitioning = false;
                }, 400);
            }

            next() {
                const nextIndex = (this.currentIndex + 1) % this.users.length;
                this.goToSlide(nextIndex);
            }

            prev() {
                const prevIndex = (this.currentIndex - 1 + this.users.length) % this.users.length;
                this.goToSlide(prevIndex);
            }

            bindEvents() {
                document.getElementById('nextBtn').addEventListener('click', () => this.next());
                document.getElementById('prevBtn').addEventListener('click', () => this.prev());
                
                // Navega√ß√£o por teclado
                document.addEventListener('keydown', (e) => {
                    if (document.getElementById('carouselView').classList.contains('active')) {
                        if (e.key === 'ArrowRight') this.next();
                        if (e.key === 'ArrowLeft') this.prev();
                    }
                });

                // Auto-play (opcional)
                // setInterval(() => {
                //     if (document.getElementById('carouselView').classList.contains('active')) {
                //         this.next();
                //     }
                // }, 5000);
            }
        }

        // Toggle entre views
        class ViewToggle {
            constructor() {
                this.currentView = 'carousel';
                this.init();
            }

            init() {
                const toggleButtons = document.querySelectorAll('.toggle-btn');
                
                toggleButtons.forEach(btn => {
                    btn.addEventListener('click', () => {
                        const viewType = btn.dataset.view;
                        this.switchView(viewType);
                        
                        // Atualizar bot√µes
                        toggleButtons.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                    });
                });
            }

            switchView(viewType) {
                const gridView = document.getElementById('gridView');
                const carouselView = document.getElementById('carouselView');
                
                if (viewType === 'grid') {
                    gridView.classList.add('active');
                    carouselView.classList.remove('active');
                    this.currentView = 'grid';
                } else {
                    carouselView.classList.add('active');
                    gridView.classList.remove('active');
                    this.currentView = 'carousel';
                }
            }
        }

        // Inicializar quando o DOM estiver carregado
        document.addEventListener('DOMContentLoaded', () => {
            const carousel = new FriendsCarousel();
            const viewToggle = new ViewToggle();
            
            console.log('Sistema de amigos inicializado!');
        });

        // Fun√ß√£o para fittar texto (mantendo a funcionalidade original)
        (function () {
            function getAvailableWidth(el) {
                const cs = getComputedStyle(el);
                const paddingX = parseFloat(cs.paddingLeft) + parseFloat(cs.paddingRight);
                const borderX = parseFloat(cs.borderLeftWidth) + parseFloat(cs.borderRightWidth);
                return el.getBoundingClientRect().width - paddingX - borderX;
            }

            function fitOne(el, min = 12, max = 22) {
                const parent = el.parentElement;
                if (!parent) return;

                el.style.whiteSpace = 'nowrap';
                el.style.overflow = 'visible';
                el.style.textOverflow = 'clip';
                el.style.display = 'inline-block';
                el.style.maxWidth = '100%';

                const avail = Math.floor(getAvailableWidth(parent));
                if (avail <= 0) return;

                let lo = min, hi = max, best = min;
                el.style.fontSize = max + 'px';

                while (lo <= hi) {
                    const mid = Math.floor((lo + hi) / 2);
                    el.style.fontSize = mid + 'px';
                    const tooWide = el.scrollWidth > avail;
                    if (tooWide) hi = mid - 1;
                    else { best = mid; lo = mid + 1; }
                }
                el.style.fontSize = best + 'px';
            }

            function fitAll(selector = '.profile-name p', min = 12, max = 22) {
                document.querySelectorAll(selector).forEach(el => fitOne(el, min, max));
            }

            function bootstrap() {
                fitAll();
                window.addEventListener('resize', () => fitAll());
                const ro = new ResizeObserver(() => fitAll());
                document.querySelectorAll('.profile-name').forEach(p => ro.observe(p));
            }

            if (document.fonts && document.fonts.ready) {
                document.fonts.ready.then(bootstrap);
            } else if (document.readyState === 'complete') {
                bootstrap();
            } else {
                window.addEventListener('load', bootstrap);
            }
        })();
    </script>

</body>
</html>