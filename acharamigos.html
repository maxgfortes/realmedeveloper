<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>RealMe</title>
  <link rel="icon" href="./src/icon/icon.png" type="image/png" />
  <meta name="theme-color" content="#1F1F1F" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="apple-touch-icon" href="./src/icon/icon.png" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link rel="stylesheet" href="./src/styles/base.css" />
  <link rel="stylesheet" href="./src/styles/sobre.css" />
  <link rel="stylesheet" href="./src/styles/amigos.css" />
  <link rel="stylesheet" href="./src/styles/media-queries.css" />
  <link rel="stylesheet" href="./src/styles/navbars.css" />
  <link rel="stylesheet" href="./src/styles/search.css" />
  <link rel="stylesheet" href="./src/styles/post-modal.css" />
</head>
<body>

  <div class="glass-overlay"></div>

  <!-- Navbar -->
  <nav>
    <div class="logo_area">
      <div class="logo">RealMe</div>
    </div>
    <div class="search-area">
  <div class="search-box">
    <button><i class="fas fa-search"></i></button>
    <input type="text" id="searchInput" placeholder="Buscar" autocomplete="off" />
  </div>
    </div>
    <div class="last-update-area">
      <div class="last-update">
        <p>Novidades!</p>
      </div>
    </div>
    <div class="marquee-container">
      <div class="marquee">marcio_marques acabou de postar uma foto...</div>
    </div>
  </nav>

  <!-- Sidebar Desktop -->
  <!-- Sidebar -->
  <aside class="sidebar">
    <a href="feed.html"><i class="fas fa-home"></i> In√≠cio</a>
    <a href="acharamigos.html"><i class="fas fa-user-friends"></i> Achar Amigos</a>
    <a href="direct.html"><i class="fas fa-comments"></i> Mensagens</a>
    <a href="nt.html"><i class="fas fa-bell"></i> Notifica√ß√µes</a>
    <a href="#" class="modalopen"><i class="fas fa-plus-square"></i> Criar</a>
    <a href="#" id="linkPerfilSidebar"><i class="fas fa-user"></i> Perfil</a>
    <!-- Menu Mais com submenu flutuante -->
        <div class="more-menu" id="moreMenu">
            <a href="#" class="more-toggle" id="moreToggle">
                <i class="fa-solid fa-bars"></i>
                Mais
            </a>
            <div class="floating-menu" id="floatingMenu">
                <a href="config.html"><i class="fas fa-cog"></i> Configura√ß√µes</a>
                <a href="invites.html"><i class="fa-solid fa-user-plus"></i> Convites</a>
                <a href="como-usar.html"><i class="fa-solid fa-book-open"></i> Como Usar</a>
                <a href="sobre.html"><i class="fas fa-question-circle"></i> Sobre</a>
                <a href="#" id="btnSair"><i class="fas fa-sign-out-alt"></i> Sair</a>
            </div>
        </div>
  </aside>
  <ul id="searchResults"></ul>

  <div class="friends-container">
        <div class="friends-header">
            <h1>Pessoas parecidas com voc√™!</h1>
            <div class="view-toggle">
                <button class="toggle-btn active" data-view="carousel">Cards</button>
                <button class="toggle-btn" data-view="grid">Grid</button>
            </div>
        </div>

        <!-- VIEW GRID (Original) -->
        <div class="grid-view" id="gridView">
            <div class="friends-list">
                <a class="user" href="#" data-username="afliccoess">
                    <img src="https://lastfm.freetls.fastly.net/i/u/avatar170s/3c04e79db06c605e5de3897555a9a34e.png" alt="Vini demarco">
                    <div class="user-name">
                        <div class="profile-name">
                            <p>Vini demarco</p>
                        </div>
                        <div class="profile-username">
                            <p>@afliccoess</p>
                        </div>
                    </div>
                </a>
                <a class="user" href="#" data-username="vampirinhaz7">
                    <img src="https://cdn.pfps.gg/pfps/1869-goth-egirl-27.png" alt="Mari">
                    <div class="user-name">
                        <div class="profile-name">
                            <p>ñ§çñ§åñ§ç Mari Saverio</p>
                        </div>
                        <div class="profile-username">
                            <p>@vampirinhaz7</p>
                        </div>
                    </div>
                </a>
                <a class="user" href="#" data-username="maxgfortes">
                    <img src="https://i.pinimg.com/736x/d6/fc/2a/d6fc2ab598fdc5ffee863bd5835746c8.jpg" alt="Max">
                    <div class="user-name">
                        <div class="profile-name">
                            <p>maxgfortes</p>
                        </div>
                        <div class="profile-username">
                            <p>@maxgfortes</p>
                        </div>
                    </div>
                </a>
                <a class="user" href="#" data-username="maxine">
                    <img src="https://i.pinimg.com/736x/0e/10/35/0e1035c960796eccbc18608793cfa3e9.jpg" alt="Maxine">
                    <div class="user-name">
                        <div class="profile-name">
                            <p>‚ãÜÀöÔΩ°‚ãÜ‡≠®‚úß‡≠ßÀö ùë¥ùíÇùíôùíäùíèùíÜ Àö‡≠®‚úß‡≠ß‚ãÜÔΩ°Àö‚ãÜ</p>
                        </div>
                        <div class="profile-username">
                            <p>@maxine</p>
                        </div>
                    </div>
                </a>
                <a class="user" href="#" data-username="davix">
                    <img src="https://i.pinimg.com/736x/12/d3/dd/12d3dd5ac7a32f43cf867161cb95774f.jpg" alt="David">
                    <div class="user-name">
                        <div class="profile-name">
                            <p>warrsex</p>
                        </div>
                        <div class="profile-username">
                            <p>@davix</p>
                        </div>
                    </div>
                </a>
                <a class="user" href="#" data-username="haspkey">
                    <img src="https://i.postimg.cc/CK3qy1w5/image.png" alt="Haspkey">
                    <div class="user-name">
                        <div class="profile-name">
                            <p>haspkey</p>
                        </div>
                        <div class="profile-username">
                            <p>@haspkey</p>
                        </div>
                    </div>
                </a>
            </div>
        </div>


  <!-- VIEW CAROUSEL (Novo) -->
        <div class="carousel-view active" id="carouselView">
            <div class="carousel-container">
                <div class="cards-wrapper" id="cardsWrapper">
                    <!-- Cards ser√£o gerados dinamicamente -->
                </div>
            </div>
            <div class="carousel-controls">
                <button class="nav-btn" id="prevBtn">‚Äπ</button>
                <div class="indicators" id="indicators"></div>
                <button class="nav-btn" id="nextBtn">‚Ä∫</button>
            </div>
        </div>
    </div>

<aside class="option-bar">
  <h1>Preferencias</h1>
  <div class="options">
      <!-- Checkbox ‚ÄúIgual a mim‚Äù -->
      <div class="lm">
        <p>Igual a mim</p>
        <label class="switch">
          <input type="checkbox" id="igualAMim">
          <span class="slider"></span>
        </label>
      </div>
  <div class="filtros">
    <div class="estilo">
      <p>Estilo</p>
      <input class="estilo" type="text" placeholder="gotico, alternativo, sk8 archive...">
    </div>

    <div class="estilo">
      <p>Personalidade</p>
      <input class="estilo" type="text" placeholder="extrovertido, introvertido...">
    </div>

    <div class="estilo">
      <p>Medos</p>
      <input class="estilo" type="text" placeholder="Medo de Acabar Sozinho...">
    </div>

    <div class="estilo">
      <p>Sonhos e Desejos</p>
      <input class="estilo" type="text" placeholder="Conex√£o real, Amor, Dinheiro...">
    </div>

    <div class="estilo">
      <p>Musicas</p>
      <input class="estilo" type="text" placeholder="Rock, Grunge, Pop, Alt, Indie...">
    </div>

    <div class="estilo">
      <p>Personagens</p>
      <input class="estilo" type="text" placeholder="Jesse Pinkman, Cassie, Marla...">
    </div>

    <div class="estilo">
      <p>localiza√ß√£o</p>
      <input class="estilo" type="text" placeholder="S√£o Paulo, Porto Alegre...">
    </div>

    <div class="estilo">
      <p>Hobbies</p>
      <input class="estilo" type="text" placeholder="Esportes, Pintura, Musica...">
    </div>

    <div class="selecoes">
      <p>Genero</p>
      <select id="genero">
        <option value="">Qualquer</option>
        <option value="Masculino">Masculino</option>
        <option value="Feminino">Feminino</option>
        <option value="binario">N√£o Binario</option>
      </select>
    </div>

    <div class="selecoes">
      <p>Estado Civil</p>
      <select id="genero">
        <option value="">Namorando</option>
        <option value="Masculino">Solteiro</option>
        <option value="Feminino">Casado</option>
        <option value="binario">Em compromisso</option>
        <option value="binario">Viuvo</option>
      </select>
    </div>

    <div class="selecoes">
      <p>MBTI</p>
      <select id="genero">
        <option value="">ISTJ</option>
        <option value="Masculino">ISFJ</option>
        <option value="Feminino">INFJ</option>
        <option value="binario">INTJ</option>
        <option value="binario">ISTP</option>
        <option value="binario">ISFP</option>
        <option value="binario">INTJ</option>
        <option value="binario">INFP</option>
        <option value="binario">INTP</option>
        <option value="binario">ESTP</option>
        <option value="binario">ESFP</option>
        <option value="binario">ENFP</option>
        <option value="binario">ENTP</option>
        <option value="binario">ESTJ</option>
        <option value="binario">ESFJ</option>
        <option value="binario">ENFJ</option>
        <option value="binario">ENTJ</option>
      </select>
    </div>    
    <div class="age">
      <div class="age-range">
        <p>Idade minima</p>
        <input class="age-input" type="number" id="idade-min" min="13" max="78" value="14">
      </div>
      <div class="age-range">
        <p>Idade Maxima</p>
        <input class="age-input" type="number" id="idade-max" min="13" max="78" step="1" value="17">
      </div>
    </div>

  </div>
</div>

  <!-- Bot√£o fixo -->
  <button class="search-btn" type="submit" form="search-form">Buscar!</button>
  </div>
</aside>
</div>

<!-- Modal Post Container -->
    <div id="postmodal" class="modal-post-container">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Criar Novo <span>Post</span>!</h2>
                <span class="close">&times;</span>
            </div>
            <div class="modal-greeting">
              <p>Como est√° sendo o seu dia? Fa√ßa um post sobre isso.</p>
            </div>
            <div class="modal-body">
                <input type="text" class="textarea-post" placeholder="Escreva um pensamento..." maxlength="100">
                <button class="btn-sending">Enviar!</button>
            </div>
        </div>
    </div>

<script src="./src/js/postmodal.js"></script>
<script src="./src/js/more.js"></script>


<script>
        // Dados dos usu√°rios
        const users = [
            {
                name: "Vini demarco",
                username: "@afliccoess",
                image: "https://lastfm.freetls.fastly.net/i/u/avatar170s/3c04e79db06c605e5de3897555a9a34e.png",
                profile: "PF.html?username=afliccoess"
            },
            {
                name: "ñ§çñ§åñ§ç Mari Saverio",
                username: "@vampirinhaz7",
                image: "https://cdn.pfps.gg/pfps/1869-goth-egirl-27.png",
                profile: "PF.html?username=vampirinhaz7"
            },
            {
                name: "maxgfortes",
                username: "@maxgfortes",
                image: "https://i.pinimg.com/736x/d6/fc/2a/d6fc2ab598fdc5ffee863bd5835746c8.jpg",
                profile: "PF.html?username=maxgfortes"
            },
            {
                name: "‚ãÜÀöÔΩ°‚ãÜ‡≠®‚úß‡≠ßÀö ùë¥ùíÇùíôùíäùíèùíÜ Àö‡≠®‚úß‡≠ß‚ãÜÔΩ°Àö‚ãÜ",
                username: "@maxine",
                image: "https://i.pinimg.com/736x/0e/10/35/0e1035c960796eccbc18608793cfa3e9.jpg",
                profile: "PF.html?username=maxine"
            },
            {
                name: "warrsex",
                username: "@davix",
                image: "https://i.pinimg.com/736x/12/d3/dd/12d3dd5ac7a32f43cf867161cb95774f.jpg",
                profile: "PF.html?username=davix"
            },
            {
                name: "haspkey",
                username: "@haspkey",
                image: "https://i.postimg.cc/CK3qy1w5/image.png",
                profile: "PF.html?username=haspkey"
            }
        ];

        class FriendsCarousel {
            constructor() {
                this.currentIndex = 0;
                this.users = users;
                this.cardsWrapper = document.getElementById('cardsWrapper');
                this.indicators = document.getElementById('indicators');
                this.isTransitioning = false;
                
                this.init();
            }

            init() {
                this.createCards();
                this.createIndicators();
                this.bindEvents();
                this.updateDisplay();
            }

            createCards() {
                this.cardsWrapper.innerHTML = '';
                
                this.users.forEach((user, index) => {
                    const card = document.createElement('div');
                    card.className = 'friend-card';
                    card.innerHTML = `
                        <div class="card-content">
                            <img src="${user.image}" alt="${user.name}" class="card-image">
                            <div class="card-info">
                                <div class="card-name">${user.name}</div>
                                <div class="card-username">${user.username}</div>
                            </div>
                            <a href="${user.profile}" class="view-profile-btn"><p>Ver Perfil</p>
                            </a>
                        </div>
                    `;
                    
                    // Adicionar event listener para navega√ß√£o por clique
                    card.addEventListener('click', (e) => {
                        if (!e.target.closest('.view-profile-btn')) {
                            this.goToSlide(index);
                        }
                    });
                    
                    this.cardsWrapper.appendChild(card);
                });
            }

            createIndicators() {
                this.indicators.innerHTML = '';
                
                this.users.forEach((_, index) => {
                    const indicator = document.createElement('div');
                    indicator.className = 'indicator';
                    if (index === 0) indicator.classList.add('active');
                    
                    indicator.addEventListener('click', () => {
                        this.goToSlide(index);
                    });
                    
                    this.indicators.appendChild(indicator);
                });
            }

            updateDisplay() {
                const cards = this.cardsWrapper.children;
                const totalCards = cards.length;
                
                // Remover todas as classes de posi√ß√£o
                Array.from(cards).forEach(card => {
                    card.classList.remove('center', 'left', 'right', 'far-left', 'far-right', 'hidden');
                });

                // Aplicar classes baseadas na posi√ß√£o relativa ao currentIndex
                Array.from(cards).forEach((card, index) => {
                    const relativePos = this.getRelativePosition(index, this.currentIndex, totalCards);
                    
                    switch (relativePos) {
                        case 0: card.classList.add('center'); break;
                        case 1: card.classList.add('right'); break;
                        case -1: card.classList.add('left'); break;
                        case 2: card.classList.add('far-right'); break;
                        case -2: card.classList.add('far-left'); break;
                        default: card.classList.add('hidden'); break;
                    }
                });

                // Atualizar indicadores
                const indicatorElements = this.indicators.children;
                Array.from(indicatorElements).forEach((indicator, index) => {
                    indicator.classList.toggle('active', index === this.currentIndex);
                });
            }

            getRelativePosition(cardIndex, currentIndex, totalCards) {
                let diff = cardIndex - currentIndex;
                
                // Normalizar para o intervalo [-totalCards/2, totalCards/2]
                if (diff > totalCards / 2) {
                    diff -= totalCards;
                } else if (diff < -totalCards / 2) {
                    diff += totalCards;
                }
                
                return diff;
            }

            goToSlide(index) {
                if (this.isTransitioning || index === this.currentIndex) return;
                
                this.isTransitioning = true;
                this.currentIndex = index;
                this.updateDisplay();
                
                // Permitir nova transi√ß√£o ap√≥s anima√ß√£o
                setTimeout(() => {
                    this.isTransitioning = false;
                }, 400);
            }

            next() {
                const nextIndex = (this.currentIndex + 1) % this.users.length;
                this.goToSlide(nextIndex);
            }

            prev() {
                const prevIndex = (this.currentIndex - 1 + this.users.length) % this.users.length;
                this.goToSlide(prevIndex);
            }

            bindEvents() {
                document.getElementById('nextBtn').addEventListener('click', () => this.next());
                document.getElementById('prevBtn').addEventListener('click', () => this.prev());
                
                // Navega√ß√£o por teclado
                document.addEventListener('keydown', (e) => {
                    if (document.getElementById('carouselView').classList.contains('active')) {
                        if (e.key === 'ArrowRight') this.next();
                        if (e.key === 'ArrowLeft') this.prev();
                    }
                });

                // Auto-play (opcional)
                // setInterval(() => {
                //     if (document.getElementById('carouselView').classList.contains('active')) {
                //         this.next();
                //     }
                // }, 5000);
            }
        }

        // Toggle entre views
        class ViewToggle {
            constructor() {
                this.currentView = 'carousel';
                this.init();
            }

            init() {
                const toggleButtons = document.querySelectorAll('.toggle-btn');
                
                toggleButtons.forEach(btn => {
                    btn.addEventListener('click', () => {
                        const viewType = btn.dataset.view;
                        this.switchView(viewType);
                        
                        // Atualizar bot√µes
                        toggleButtons.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                    });
                });
            }

            switchView(viewType) {
                const gridView = document.getElementById('gridView');
                const carouselView = document.getElementById('carouselView');
                
                if (viewType === 'grid') {
                    gridView.classList.add('active');
                    carouselView.classList.remove('active');
                    this.currentView = 'grid';
                } else {
                    carouselView.classList.add('active');
                    gridView.classList.remove('active');
                    this.currentView = 'carousel';
                }
            }
        }

        // Inicializar quando o DOM estiver carregado
        document.addEventListener('DOMContentLoaded', () => {
            const carousel = new FriendsCarousel();
            const viewToggle = new ViewToggle();
            
            console.log('Sistema de amigos inicializado!');
        });

        // Fun√ß√£o para fittar texto (mantendo a funcionalidade original)
        (function () {
            function getAvailableWidth(el) {
                const cs = getComputedStyle(el);
                const paddingX = parseFloat(cs.paddingLeft) + parseFloat(cs.paddingRight);
                const borderX = parseFloat(cs.borderLeftWidth) + parseFloat(cs.borderRightWidth);
                return el.getBoundingClientRect().width - paddingX - borderX;
            }

            function fitOne(el, min = 12, max = 22) {
                const parent = el.parentElement;
                if (!parent) return;

                el.style.whiteSpace = 'nowrap';
                el.style.overflow = 'visible';
                el.style.textOverflow = 'clip';
                el.style.display = 'inline-block';
                el.style.maxWidth = '100%';

                const avail = Math.floor(getAvailableWidth(parent));
                if (avail <= 0) return;

                let lo = min, hi = max, best = min;
                el.style.fontSize = max + 'px';

                while (lo <= hi) {
                    const mid = Math.floor((lo + hi) / 2);
                    el.style.fontSize = mid + 'px';
                    const tooWide = el.scrollWidth > avail;
                    if (tooWide) hi = mid - 1;
                    else { best = mid; lo = mid + 1; }
                }
                el.style.fontSize = best + 'px';
            }

            function fitAll(selector = '.profile-name p', min = 12, max = 22) {
                document.querySelectorAll(selector).forEach(el => fitOne(el, min, max));
            }

            function bootstrap() {
                fitAll();
                window.addEventListener('resize', () => fitAll());
                const ro = new ResizeObserver(() => fitAll());
                document.querySelectorAll('.profile-name').forEach(p => ro.observe(p));
            }

            if (document.fonts && document.fonts.ready) {
                document.fonts.ready.then(bootstrap);
            } else if (document.readyState === 'complete') {
                bootstrap();
            } else {
                window.addEventListener('load', bootstrap);
            }
        })();
</script>
<script type="module">
  import {
  getFirestore,
  collection,
  getDocs,
  doc,
  getDoc
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";
import {
  getAuth,
  onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";

// Inicializa Firebase
const db = getFirestore();
const auth = getAuth();

// Fun√ß√£o para pegar filtros dos inputs do seu HTML
function getFiltros() {
  return {
    estilo: document.querySelector('input[placeholder*="estilo"]')?.value.trim().toLowerCase() || "",
    personalidade: document.querySelector('input[placeholder*="Personalidade"]')?.value.trim().toLowerCase() || "",
    medos: document.querySelector('input[placeholder*="Medos"]')?.value.trim().toLowerCase() || "",
    sonhos: document.querySelector('input[placeholder*="Sonhos"]')?.value.trim().toLowerCase() || "",
    musicas: document.querySelector('input[placeholder*="Musicas"]')?.value.trim().toLowerCase() || "",
    personagens: document.querySelector('input[placeholder*="Personagens"]')?.value.trim().toLowerCase() || "",
    localizacao: document.querySelector('input[placeholder*="localiza√ß√£o"]')?.value.trim().toLowerCase() || "",
    hobbies: document.querySelector('input[placeholder*="Hobbies"]')?.value.trim().toLowerCase() || "",
    genero: document.getElementById('genero')?.value || "",
    idadeMin: parseInt(document.getElementById('idade-min')?.value) || 13,
    idadeMax: parseInt(document.getElementById('idade-max')?.value) || 99
  };
}

// Fun√ß√£o para buscar dados do usu√°rio logado (igual a mim)
async function getMeuPerfil(uid) {
  const userRef = doc(db, "users", uid);
  const userSnap = await getDoc(userRef);
  return userSnap.exists() ? userSnap.data() : null;
}

// Algoritmo de match simples
function calcularScore(user, filtros) {
  let score = 0;
  if (filtros.estilo && user.estilo && user.estilo.toLowerCase().includes(filtros.estilo)) score++;
  if (filtros.personalidade && user.personalidade && user.personalidade.toLowerCase().includes(filtros.personalidade)) score++;
  if (filtros.medos && user.medos && user.medos.toLowerCase().includes(filtros.medos)) score++;
  if (filtros.sonhos && user.sonhos && user.sonhos.toLowerCase().includes(filtros.sonhos)) score++;
  if (filtros.musicas && user.musicas && user.musicas.toLowerCase().includes(filtros.musicas)) score++;
  if (filtros.personagens && user.personagens && user.personagens.toLowerCase().includes(filtros.personagens)) score++;
  if (filtros.localizacao && user.localizacao && user.localizacao.toLowerCase().includes(filtros.localizacao)) score++;
  if (filtros.hobbies && user.hobbies && user.hobbies.toLowerCase().includes(filtros.hobbies)) score++;
  if (filtros.genero && user.genero && user.genero === filtros.genero) score++;
  if (user.idade && user.idade >= filtros.idadeMin && user.idade <= filtros.idadeMax) score++;
  return score;
}

// Busca perfis e calcula match
async function buscarPerfis(filtros, meuUid) {
  const usersRef = collection(db, "users");
  const snapshot = await getDocs(usersRef);
  const resultados = [];

  snapshot.forEach(docSnap => {
    const user = docSnap.data();
    // N√£o mostra o pr√≥prio perfil
    if (docSnap.id === meuUid) return;
    const score = calcularScore(user, filtros);
    if (score > 0) {
      resultados.push({ ...user, score });
    }
  });

  // Ordena por score (mais parecido primeiro)
  resultados.sort((a, b) => b.score - a.score);
  return resultados;
}

// Mostra os resultados na tela (cards)
function mostrarResultados(resultados) {
  const wrapper = document.getElementById('cardsWrapper');
  wrapper.innerHTML = '';
  if (resultados.length === 0) {
    wrapper.innerHTML = '<p>Nenhum perfil parecido encontrado.</p>';
    return;
  }
  resultados.forEach(user => {
    const card = document.createElement('div');
    card.className = 'friend-card';
    card.innerHTML = `
      <div class="card-content">
        <img src="${user.userphoto || './src/icon/default.jpg'}" alt="${user.displayname}">
        <div class="card-info">
          <div class="card-name">${user.displayname}</div>
          <div class="card-username">@${user.username}</div>
          <div class="card-score">Match: ${user.score}</div>
        </div>
        <a href="PF.html?username=${user.username}" class="view-profile-btn"><p>Ver Perfil</p></a>
      </div>
    `;
    wrapper.appendChild(card);
  });
}

// Deixa filtros escuros e inclic√°veis se "Igual a mim" estiver ativado
function toggleFiltrosDesabilitados(desabilitar) {
  document.querySelectorAll('.filtros input, .filtros select, .filtros .age-input').forEach(el => {
    el.disabled = desabilitar;
    el.style.opacity = desabilitar ? '0.5' : '1';
    el.style.pointerEvents = desabilitar ? 'none' : 'auto';
  });
}

// Evento do switch "Igual a mim"
document.getElementById('igualAMim').addEventListener('change', function() {
  toggleFiltrosDesabilitados(this.checked);
});

// Evento do bot√£o Buscar!
document.querySelector('.search-btn').addEventListener('click', async (e) => {
  e.preventDefault();
  onAuthStateChanged(auth, async (user) => {
    if (!user) return;
    let filtros = getFiltros();

    // Se "Igual a mim" estiver marcado, usa seu perfil como filtro
    const igualAMim = document.getElementById('igualAMim')?.checked;
    let meuUid = user.uid;
    if (igualAMim) {
      const meuPerfil = await getMeuPerfil(meuUid);
      if (meuPerfil) {
        filtros = {
          estilo: meuPerfil.estilo || "",
          personalidade: meuPerfil.personalidade || "",
          medos: meuPerfil.medos || "",
          sonhos: meuPerfil.sonhos || "",
          musicas: meuPerfil.musicas || "",
          personagens: meuPerfil.personagens || "",
          localizacao: meuPerfil.localizacao || "",
          hobbies: meuPerfil.hobbies || "",
          genero: meuPerfil.genero || "",
          idadeMin: meuPerfil.idade || 13,
          idadeMax: meuPerfil.idade || 99
        };
      }
    }

    const resultados = await buscarPerfis(filtros, meuUid);
    mostrarResultados(resultados);
  });
});
</script>
<script src="./block.js"></script>

</body>
</html>